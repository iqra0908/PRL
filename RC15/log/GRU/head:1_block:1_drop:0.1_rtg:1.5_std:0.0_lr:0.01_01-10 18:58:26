WARNING:tensorflow:From /Users/xin/Documents/RL4REC/RC15/GRU_PRL.py:122: The name tf.random_normal is deprecated. Please use tf.random.normal instead.

WARNING:tensorflow:From /Users/xin/Documents/RL4REC/RC15/GRU_PRL.py:56: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /Users/xin/Documents/RL4REC/RC15/GRU_PRL.py:68: GRUCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.GRUCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /Users/xin/Documents/RL4REC/RC15/GRU_PRL.py:71: dynamic_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell)`, which is equivalent to this API
WARNING:tensorflow:From /Users/xin/miniconda3/envs/tf-1.15/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:559: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /Users/xin/miniconda3/envs/tf-1.15/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:565: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /Users/xin/miniconda3/envs/tf-1.15/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:575: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /Users/xin/miniconda3/envs/tf-1.15/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn.py:244: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /Users/xin/Documents/RL4REC/RC15/GRU_PRL.py:84: dropout (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.dropout instead.
WARNING:tensorflow:From /Users/xin/miniconda3/envs/tf-1.15/lib/python3.7/site-packages/tensorflow_core/python/layers/core.py:271: Layer.apply (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.__call__` method instead.
WARNING:tensorflow:From /Users/xin/Documents/RL4REC/RC15/GRU_PRL.py:89: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /Users/xin/Documents/RL4REC/RC15/SASRecModules.py:142: dense (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.Dense instead.
WARNING:tensorflow:From /Users/xin/Documents/RL4REC/RC15/GRU_PRL.py:118: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /Users/xin/Documents/RL4REC/RC15/GRU_PRL.py:241: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /Users/xin/Documents/RL4REC/RC15/GRU_PRL.py:244: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

WARNING:tensorflow:From /Users/xin/Documents/RL4REC/RC15/GRU_PRL.py:246: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

INFO:root:the loss in 200th batch is: 1.739195
INFO:root:the loss in 400th batch is: 1.579790
INFO:root:the loss in 600th batch is: 1.441854
INFO:root:the loss in 800th batch is: 1.587206
INFO:root:the loss in 1000th batch is: 1.422324
INFO:root:the loss in 1200th batch is: 1.326274
INFO:root:the loss in 1400th batch is: 1.306402
INFO:root:the loss in 1600th batch is: 1.425463
INFO:root:the loss in 1800th batch is: 1.317695
INFO:root:the loss in 2000th batch is: 1.410471
INFO:root:#############################################################
INFO:root:total clicks: 108416, total purchase:4245
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 5: 7594.800000
INFO:root:clicks hr ndcg @ 5 : 0.268447, 0.184339
INFO:root:purchase hr and ndcg @5 : 0.417903, 0.294076
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 10: 9966.200000
INFO:root:clicks hr ndcg @ 10 : 0.354708, 0.212311
INFO:root:purchase hr and ndcg @10 : 0.535925, 0.332431
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 15: 11165.600000
INFO:root:clicks hr ndcg @ 15 : 0.400937, 0.224572
INFO:root:purchase hr and ndcg @15 : 0.582332, 0.344744
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 20: 11962.600000
INFO:root:clicks hr ndcg @ 20 : 0.430545, 0.231569
INFO:root:purchase hr and ndcg @20 : 0.618846, 0.353346
INFO:root:#############################################################
INFO:root:the loss in 2200th batch is: 1.304726
INFO:root:the loss in 2400th batch is: 1.260417
INFO:root:the loss in 2600th batch is: 1.321274
INFO:root:the loss in 2800th batch is: 1.205188
INFO:root:the loss in 3000th batch is: 1.253228
INFO:root:the loss in 3200th batch is: 1.105034
INFO:root:the loss in 3400th batch is: 1.225371
INFO:root:the loss in 3600th batch is: 1.108139
INFO:root:the loss in 3800th batch is: 1.201181
INFO:root:the loss in 4000th batch is: 1.157794
INFO:root:#############################################################
INFO:root:total clicks: 108416, total purchase:4245
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 5: 7986.800000
INFO:root:clicks hr ndcg @ 5 : 0.283528, 0.194213
INFO:root:purchase hr and ndcg @5 : 0.433216, 0.309635
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 10: 10491.800000
INFO:root:clicks hr ndcg @ 10 : 0.376227, 0.224267
INFO:root:purchase hr and ndcg @10 : 0.549823, 0.347545
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 15: 11779.600000
INFO:root:clicks hr ndcg @ 15 : 0.424365, 0.237029
INFO:root:purchase hr and ndcg @15 : 0.607303, 0.362797
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 20: 12609.000000
INFO:root:clicks hr ndcg @ 20 : 0.455514, 0.244396
INFO:root:purchase hr and ndcg @20 : 0.643581, 0.371387
INFO:root:#############################################################
INFO:root:the loss in 4200th batch is: 1.225514
INFO:root:the loss in 4400th batch is: 1.297584
INFO:root:the loss in 4600th batch is: 1.190017
INFO:root:the loss in 4800th batch is: 1.181074
INFO:root:the loss in 5000th batch is: 1.265996
INFO:root:the loss in 5200th batch is: 1.262462
INFO:root:the loss in 5400th batch is: 1.184196
INFO:root:the loss in 5600th batch is: 1.189582
INFO:root:the loss in 5800th batch is: 1.244352
INFO:root:the loss in 6000th batch is: 1.197952
INFO:root:#############################################################
INFO:root:total clicks: 108416, total purchase:4245
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 5: 8226.400000
INFO:root:clicks hr ndcg @ 5 : 0.291258, 0.200376
INFO:root:purchase hr and ndcg @5 : 0.450177, 0.321669
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 10: 10668.400000
INFO:root:clicks hr ndcg @ 10 : 0.383449, 0.230285
INFO:root:purchase hr and ndcg @10 : 0.554535, 0.355674
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 15: 11930.800000
INFO:root:clicks hr ndcg @ 15 : 0.431615, 0.243057
INFO:root:purchase hr and ndcg @15 : 0.605889, 0.369351
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 20: 12757.400000
INFO:root:clicks hr ndcg @ 20 : 0.462865, 0.250441
INFO:root:purchase hr and ndcg @20 : 0.640989, 0.377633
INFO:root:#############################################################
INFO:root:the loss in 6200th batch is: 1.203734
INFO:root:the loss in 6400th batch is: 1.119967
INFO:root:the loss in 6600th batch is: 1.222055
INFO:root:the loss in 6800th batch is: 1.215840
INFO:root:the loss in 7000th batch is: 1.106858
INFO:root:the loss in 7200th batch is: 1.153575
INFO:root:the loss in 7400th batch is: 1.299891
INFO:root:the loss in 7600th batch is: 1.181444
INFO:root:the loss in 7800th batch is: 1.208881
INFO:root:the loss in 8000th batch is: 1.220853
INFO:root:#############################################################
INFO:root:total clicks: 108416, total purchase:4245
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 5: 8268.000000
INFO:root:clicks hr ndcg @ 5 : 0.295067, 0.203452
INFO:root:purchase hr and ndcg @5 : 0.440518, 0.313597
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 10: 10709.200000
INFO:root:clicks hr ndcg @ 10 : 0.385746, 0.232901
INFO:root:purchase hr and ndcg @10 : 0.552415, 0.350086
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 15: 12006.200000
INFO:root:clicks hr ndcg @ 15 : 0.434078, 0.245708
INFO:root:purchase hr and ndcg @15 : 0.611072, 0.365657
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 20: 12856.800000
INFO:root:clicks hr ndcg @ 20 : 0.466112, 0.253273
INFO:root:purchase hr and ndcg @20 : 0.647821, 0.374357
INFO:root:#############################################################
INFO:root:the loss in 8200th batch is: 1.131302
INFO:root:the loss in 8400th batch is: 1.135552
INFO:root:the loss in 8600th batch is: 1.111756
INFO:root:the loss in 8800th batch is: 1.127685
INFO:root:the loss in 9000th batch is: 1.166070
INFO:root:the loss in 9200th batch is: 1.010535
INFO:root:the loss in 9400th batch is: 1.076499
INFO:root:the loss in 9600th batch is: 1.130362
INFO:root:the loss in 9800th batch is: 1.093560
INFO:root:the loss in 10000th batch is: 1.106423
INFO:root:#############################################################
INFO:root:total clicks: 108416, total purchase:4245
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 5: 8317.400000
INFO:root:clicks hr ndcg @ 5 : 0.297299, 0.204960
INFO:root:purchase hr and ndcg @5 : 0.440754, 0.315312
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 10: 10839.000000
INFO:root:clicks hr ndcg @ 10 : 0.390487, 0.235155
INFO:root:purchase hr and ndcg @10 : 0.558775, 0.353554
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 15: 12121.800000
INFO:root:clicks hr ndcg @ 15 : 0.438579, 0.247898
INFO:root:purchase hr and ndcg @15 : 0.615312, 0.368507
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 20: 12959.800000
INFO:root:clicks hr ndcg @ 20 : 0.470124, 0.255357
INFO:root:purchase hr and ndcg @20 : 0.651590, 0.377113
INFO:root:#############################################################
INFO:root:the loss in 10200th batch is: 1.234895
INFO:root:the loss in 10400th batch is: 1.119028
INFO:root:the loss in 10600th batch is: 1.033884
INFO:root:the loss in 10800th batch is: 1.229879
INFO:root:the loss in 11000th batch is: 1.055862
INFO:root:the loss in 11200th batch is: 1.246359
INFO:root:the loss in 11400th batch is: 1.196869
INFO:root:the loss in 11600th batch is: 1.157821
INFO:root:the loss in 11800th batch is: 1.188542
INFO:root:the loss in 12000th batch is: 1.134822
INFO:root:#############################################################
INFO:root:total clicks: 108416, total purchase:4245
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 5: 8227.800000
INFO:root:clicks hr ndcg @ 5 : 0.293813, 0.202400
INFO:root:purchase hr and ndcg @5 : 0.437456, 0.311642
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 10: 10659.000000
INFO:root:clicks hr ndcg @ 10 : 0.384630, 0.231873
INFO:root:purchase hr and ndcg @10 : 0.546290, 0.347065
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 15: 11943.800000
INFO:root:clicks hr ndcg @ 15 : 0.432814, 0.244644
INFO:root:purchase hr and ndcg @15 : 0.602827, 0.362070
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 20: 12789.800000
INFO:root:clicks hr ndcg @ 20 : 0.464775, 0.252194
INFO:root:purchase hr and ndcg @20 : 0.638869, 0.370574
INFO:root:#############################################################
INFO:root:the loss in 12200th batch is: 1.111393
INFO:root:the loss in 12400th batch is: 1.049836
INFO:root:the loss in 12600th batch is: 1.125580
INFO:root:the loss in 12800th batch is: 1.079253
INFO:root:the loss in 13000th batch is: 1.107068
INFO:root:the loss in 13200th batch is: 1.163364
INFO:root:the loss in 13400th batch is: 1.104704
INFO:root:the loss in 13600th batch is: 1.095278
INFO:root:the loss in 13800th batch is: 1.187712
INFO:root:the loss in 14000th batch is: 1.140077
INFO:root:#############################################################
INFO:root:total clicks: 108416, total purchase:4245
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 5: 8208.000000
INFO:root:clicks hr ndcg @ 5 : 0.293130, 0.202416
INFO:root:purchase hr and ndcg @5 : 0.436278, 0.308730
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 10: 10692.200000
INFO:root:clicks hr ndcg @ 10 : 0.386068, 0.232558
INFO:root:purchase hr and ndcg @10 : 0.546761, 0.344624
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 15: 11950.800000
INFO:root:clicks hr ndcg @ 15 : 0.433414, 0.245102
INFO:root:purchase hr and ndcg @15 : 0.601413, 0.359100
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 20: 12802.000000
INFO:root:clicks hr ndcg @ 20 : 0.464599, 0.252473
INFO:root:purchase hr and ndcg @20 : 0.642638, 0.368840
INFO:root:#############################################################
INFO:root:the loss in 14200th batch is: 1.077182
INFO:root:the loss in 14400th batch is: 1.067233
INFO:root:the loss in 14600th batch is: 1.160858
INFO:root:the loss in 14800th batch is: 1.069327
INFO:root:the loss in 15000th batch is: 1.069482
INFO:root:the loss in 15200th batch is: 1.068604
INFO:root:the loss in 15400th batch is: 1.173873
INFO:root:the loss in 15600th batch is: 1.078726
INFO:root:the loss in 15800th batch is: 1.094015
INFO:root:the loss in 16000th batch is: 1.123914
