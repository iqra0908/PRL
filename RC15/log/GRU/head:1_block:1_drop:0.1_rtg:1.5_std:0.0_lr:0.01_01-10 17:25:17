WARNING:tensorflow:From /Users/xin/Documents/RL4REC/RC15/GRU_PRL.py:122: The name tf.random_normal is deprecated. Please use tf.random.normal instead.

WARNING:tensorflow:From /Users/xin/Documents/RL4REC/RC15/GRU_PRL.py:56: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /Users/xin/Documents/RL4REC/RC15/GRU_PRL.py:68: GRUCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.GRUCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /Users/xin/Documents/RL4REC/RC15/GRU_PRL.py:71: dynamic_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell)`, which is equivalent to this API
WARNING:tensorflow:From /Users/xin/miniconda3/envs/tf-1.15/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:559: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /Users/xin/miniconda3/envs/tf-1.15/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:565: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /Users/xin/miniconda3/envs/tf-1.15/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:575: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /Users/xin/miniconda3/envs/tf-1.15/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn.py:244: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /Users/xin/Documents/RL4REC/RC15/GRU_PRL.py:84: dropout (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.dropout instead.
WARNING:tensorflow:From /Users/xin/miniconda3/envs/tf-1.15/lib/python3.7/site-packages/tensorflow_core/python/layers/core.py:271: Layer.apply (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.__call__` method instead.
WARNING:tensorflow:From /Users/xin/Documents/RL4REC/RC15/GRU_PRL.py:89: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /Users/xin/Documents/RL4REC/RC15/SASRecModules.py:142: dense (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.Dense instead.
WARNING:tensorflow:From /Users/xin/Documents/RL4REC/RC15/SASRecModules.py:223: conv1d (from tensorflow.python.layers.convolutional) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.keras.layers.Conv1D` instead.
WARNING:tensorflow:From /Users/xin/Documents/RL4REC/RC15/GRU_PRL.py:118: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /Users/xin/Documents/RL4REC/RC15/GRU_PRL.py:241: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /Users/xin/Documents/RL4REC/RC15/GRU_PRL.py:244: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

WARNING:tensorflow:From /Users/xin/Documents/RL4REC/RC15/GRU_PRL.py:246: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

INFO:root:the loss in 200th batch is: 1.673628
INFO:root:the loss in 400th batch is: 1.486042
INFO:root:the loss in 600th batch is: 1.609188
INFO:root:the loss in 800th batch is: 1.481384
INFO:root:the loss in 1000th batch is: 1.527241
INFO:root:the loss in 1200th batch is: 1.419080
INFO:root:the loss in 1400th batch is: 1.393486
INFO:root:the loss in 1600th batch is: 1.224618
INFO:root:the loss in 1800th batch is: 1.222402
INFO:root:the loss in 2000th batch is: 1.312642
INFO:root:#############################################################
INFO:root:total clicks: 108416, total purchase:4245
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 5: 7352.400000
INFO:root:clicks hr ndcg @ 5 : 0.258698, 0.177571
INFO:root:purchase hr and ndcg @5 : 0.410601, 0.287464
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 10: 9641.000000
INFO:root:clicks hr ndcg @ 10 : 0.343399, 0.205056
INFO:root:purchase hr and ndcg @10 : 0.517079, 0.322131
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 15: 10823.200000
INFO:root:clicks hr ndcg @ 15 : 0.387452, 0.216726
INFO:root:purchase hr and ndcg @15 : 0.570554, 0.336289
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 20: 11612.800000
INFO:root:clicks hr ndcg @ 20 : 0.417918, 0.223937
INFO:root:purchase hr and ndcg @20 : 0.600942, 0.343469
INFO:root:#############################################################
INFO:root:the loss in 2200th batch is: 1.298019
INFO:root:the loss in 2400th batch is: 1.335008
INFO:root:the loss in 2600th batch is: 1.256104
INFO:root:the loss in 2800th batch is: 1.217099
INFO:root:the loss in 3000th batch is: 1.320214
INFO:root:the loss in 3200th batch is: 1.198111
INFO:root:the loss in 3400th batch is: 1.287725
INFO:root:the loss in 3600th batch is: 1.368870
INFO:root:the loss in 3800th batch is: 1.273079
INFO:root:the loss in 4000th batch is: 1.146316
INFO:root:#############################################################
INFO:root:total clicks: 108416, total purchase:4245
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 5: 7939.200000
INFO:root:clicks hr ndcg @ 5 : 0.280503, 0.193234
INFO:root:purchase hr and ndcg @5 : 0.437456, 0.307045
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 10: 10379.600000
INFO:root:clicks hr ndcg @ 10 : 0.370268, 0.222430
INFO:root:purchase hr and ndcg @10 : 0.553828, 0.344803
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 15: 11620.000000
INFO:root:clicks hr ndcg @ 15 : 0.416774, 0.234745
INFO:root:purchase hr and ndcg @15 : 0.608481, 0.359303
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 20: 12446.800000
INFO:root:clicks hr ndcg @ 20 : 0.447941, 0.242115
INFO:root:purchase hr and ndcg @20 : 0.644052, 0.367716
INFO:root:#############################################################
INFO:root:the loss in 4200th batch is: 1.312526
INFO:root:the loss in 4400th batch is: 1.126553
INFO:root:the loss in 4600th batch is: 1.167051
INFO:root:the loss in 4800th batch is: 1.250082
INFO:root:the loss in 5000th batch is: 1.111413
INFO:root:the loss in 5200th batch is: 1.051876
INFO:root:the loss in 5400th batch is: 1.198568
INFO:root:the loss in 5600th batch is: 1.185683
INFO:root:the loss in 5800th batch is: 1.189639
INFO:root:the loss in 6000th batch is: 1.180284
INFO:root:#############################################################
INFO:root:total clicks: 108416, total purchase:4245
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 5: 8103.000000
INFO:root:clicks hr ndcg @ 5 : 0.287550, 0.198039
INFO:root:purchase hr and ndcg @5 : 0.440047, 0.309714
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 10: 10578.200000
INFO:root:clicks hr ndcg @ 10 : 0.379105, 0.227707
INFO:root:purchase hr and ndcg @10 : 0.555477, 0.347102
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 15: 11843.200000
INFO:root:clicks hr ndcg @ 15 : 0.426653, 0.240294
INFO:root:purchase hr and ndcg @15 : 0.610601, 0.361661
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 20: 12650.000000
INFO:root:clicks hr ndcg @ 20 : 0.457543, 0.247605
INFO:root:purchase hr and ndcg @20 : 0.642874, 0.369291
INFO:root:#############################################################
INFO:root:the loss in 6200th batch is: 1.128377
INFO:root:the loss in 6400th batch is: 1.130912
INFO:root:the loss in 6600th batch is: 1.003931
INFO:root:the loss in 6800th batch is: 1.243272
INFO:root:the loss in 7000th batch is: 1.182609
INFO:root:the loss in 7200th batch is: 1.221331
INFO:root:the loss in 7400th batch is: 1.203246
INFO:root:the loss in 7600th batch is: 1.178423
INFO:root:the loss in 7800th batch is: 1.232756
INFO:root:the loss in 8000th batch is: 1.151715
INFO:root:#############################################################
INFO:root:total clicks: 108416, total purchase:4245
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 5: 8227.800000
INFO:root:clicks hr ndcg @ 5 : 0.290953, 0.200853
INFO:root:purchase hr and ndcg @5 : 0.452061, 0.322233
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 10: 10650.600000
INFO:root:clicks hr ndcg @ 10 : 0.381475, 0.230254
INFO:root:purchase hr and ndcg @10 : 0.560424, 0.357378
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 15: 11905.600000
INFO:root:clicks hr ndcg @ 15 : 0.428793, 0.242798
INFO:root:purchase hr and ndcg @15 : 0.614370, 0.371742
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 20: 12773.200000
INFO:root:clicks hr ndcg @ 20 : 0.461841, 0.250608
INFO:root:purchase hr and ndcg @20 : 0.649941, 0.380133
INFO:root:#############################################################
INFO:root:the loss in 8200th batch is: 1.157523
INFO:root:the loss in 8400th batch is: 1.183152
INFO:root:the loss in 8600th batch is: 1.088933
INFO:root:the loss in 8800th batch is: 1.146882
INFO:root:the loss in 9000th batch is: 1.158190
INFO:root:the loss in 9200th batch is: 1.216184
INFO:root:the loss in 9400th batch is: 1.221659
INFO:root:the loss in 9600th batch is: 1.098670
INFO:root:the loss in 9800th batch is: 1.239522
INFO:root:the loss in 10000th batch is: 1.103271
INFO:root:#############################################################
INFO:root:total clicks: 108416, total purchase:4245
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 5: 8310.800000
INFO:root:clicks hr ndcg @ 5 : 0.294735, 0.203268
INFO:root:purchase hr and ndcg @5 : 0.452297, 0.322375
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 10: 10750.200000
INFO:root:clicks hr ndcg @ 10 : 0.385976, 0.232876
INFO:root:purchase hr and ndcg @10 : 0.560895, 0.357673
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 15: 12025.600000
INFO:root:clicks hr ndcg @ 15 : 0.433774, 0.245544
INFO:root:purchase hr and ndcg @15 : 0.617197, 0.372640
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 20: 12827.000000
INFO:root:clicks hr ndcg @ 20 : 0.464415, 0.252785
INFO:root:purchase hr and ndcg @20 : 0.649470, 0.380252
INFO:root:#############################################################
INFO:root:the loss in 10200th batch is: 1.106955
INFO:root:the loss in 10400th batch is: 1.167942
INFO:root:the loss in 10600th batch is: 1.189581
INFO:root:the loss in 10800th batch is: 1.101656
INFO:root:the loss in 11000th batch is: 1.116885
INFO:root:the loss in 11200th batch is: 1.184204
INFO:root:the loss in 11400th batch is: 1.192276
INFO:root:the loss in 11600th batch is: 1.107987
INFO:root:the loss in 11800th batch is: 1.168666
INFO:root:the loss in 12000th batch is: 1.162939
INFO:root:#############################################################
INFO:root:total clicks: 108416, total purchase:4245
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 5: 8289.200000
INFO:root:clicks hr ndcg @ 5 : 0.294108, 0.202904
INFO:root:purchase hr and ndcg @5 : 0.450412, 0.322261
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 10: 10717.400000
INFO:root:clicks hr ndcg @ 10 : 0.384832, 0.232350
INFO:root:purchase hr and ndcg @10 : 0.559011, 0.357727
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 15: 11992.800000
INFO:root:clicks hr ndcg @ 15 : 0.432676, 0.245022
INFO:root:purchase hr and ndcg @15 : 0.615077, 0.372551
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 20: 12811.600000
INFO:root:clicks hr ndcg @ 20 : 0.463889, 0.252401
INFO:root:purchase hr and ndcg @20 : 0.648528, 0.380447
INFO:root:#############################################################
INFO:root:the loss in 12200th batch is: 1.037137
INFO:root:the loss in 12400th batch is: 1.114679
INFO:root:the loss in 12600th batch is: 1.233628
INFO:root:the loss in 12800th batch is: 1.086569
INFO:root:the loss in 13000th batch is: 1.214922
INFO:root:the loss in 13200th batch is: 1.070076
INFO:root:the loss in 13400th batch is: 1.154141
INFO:root:the loss in 13600th batch is: 1.162037
INFO:root:the loss in 13800th batch is: 0.981187
INFO:root:the loss in 14000th batch is: 1.193395
INFO:root:#############################################################
INFO:root:total clicks: 108416, total purchase:4245
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 5: 8239.200000
INFO:root:clicks hr ndcg @ 5 : 0.292770, 0.202435
INFO:root:purchase hr and ndcg @5 : 0.445465, 0.313940
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 10: 10745.000000
INFO:root:clicks hr ndcg @ 10 : 0.385367, 0.232458
INFO:root:purchase hr and ndcg @10 : 0.562780, 0.352002
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 15: 11997.400000
INFO:root:clicks hr ndcg @ 15 : 0.431505, 0.244685
INFO:root:purchase hr and ndcg @15 : 0.622144, 0.367720
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 20: 12812.400000
INFO:root:clicks hr ndcg @ 20 : 0.462496, 0.252013
INFO:root:purchase hr and ndcg @20 : 0.655830, 0.375703
INFO:root:#############################################################
INFO:root:the loss in 14200th batch is: 1.128859
INFO:root:the loss in 14400th batch is: 1.114246
INFO:root:the loss in 14600th batch is: 1.173717
INFO:root:the loss in 14800th batch is: 1.127703
INFO:root:the loss in 15000th batch is: 1.053146
INFO:root:the loss in 15200th batch is: 1.060321
INFO:root:the loss in 15400th batch is: 1.165051
INFO:root:the loss in 15600th batch is: 1.148265
INFO:root:the loss in 15800th batch is: 1.067058
INFO:root:the loss in 16000th batch is: 1.162409
INFO:root:#############################################################
INFO:root:total clicks: 108416, total purchase:4245
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 5: 8268.800000
INFO:root:clicks hr ndcg @ 5 : 0.294366, 0.203782
INFO:root:purchase hr and ndcg @5 : 0.444287, 0.316932
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 10: 10759.400000
INFO:root:clicks hr ndcg @ 10 : 0.385985, 0.233540
INFO:root:purchase hr and ndcg @10 : 0.563015, 0.355502
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 15: 12023.800000
INFO:root:clicks hr ndcg @ 15 : 0.433414, 0.246106
INFO:root:purchase hr and ndcg @15 : 0.618610, 0.370200
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 20: 12859.600000
INFO:root:clicks hr ndcg @ 20 : 0.464535, 0.253462
INFO:root:purchase hr and ndcg @20 : 0.656537, 0.379177
INFO:root:#############################################################
INFO:root:the loss in 16200th batch is: 1.144273
INFO:root:the loss in 16400th batch is: 1.181571
INFO:root:the loss in 16600th batch is: 1.147212
INFO:root:the loss in 16800th batch is: 1.108010
INFO:root:the loss in 17000th batch is: 1.080610
INFO:root:the loss in 17200th batch is: 1.124781
INFO:root:the loss in 17400th batch is: 1.162354
INFO:root:the loss in 17600th batch is: 1.081576
INFO:root:the loss in 17800th batch is: 1.173085
INFO:root:the loss in 18000th batch is: 1.075272
INFO:root:#############################################################
INFO:root:total clicks: 108416, total purchase:4245
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 5: 8320.600000
INFO:root:clicks hr ndcg @ 5 : 0.294956, 0.203046
INFO:root:purchase hr and ndcg @5 : 0.453475, 0.320520
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 10: 10770.000000
INFO:root:clicks hr ndcg @ 10 : 0.386336, 0.232703
INFO:root:purchase hr and ndcg @10 : 0.563722, 0.356322
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 15: 11991.600000
INFO:root:clicks hr ndcg @ 15 : 0.433128, 0.245110
INFO:root:purchase hr and ndcg @15 : 0.612485, 0.369293
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 20: 12818.800000
INFO:root:clicks hr ndcg @ 20 : 0.464452, 0.252513
INFO:root:purchase hr and ndcg @20 : 0.647350, 0.377535
INFO:root:#############################################################
INFO:root:the loss in 18200th batch is: 1.105999
INFO:root:the loss in 18400th batch is: 1.085450
INFO:root:the loss in 18600th batch is: 1.092331
INFO:root:the loss in 18800th batch is: 1.113643
INFO:root:the loss in 19000th batch is: 1.127715
INFO:root:the loss in 19200th batch is: 1.165211
INFO:root:the loss in 19400th batch is: 1.110605
INFO:root:the loss in 19600th batch is: 1.056897
INFO:root:the loss in 19800th batch is: 1.132128
INFO:root:the loss in 20000th batch is: 1.143557
INFO:root:#############################################################
INFO:root:total clicks: 108416, total purchase:4245
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 5: 8299.400000
INFO:root:clicks hr ndcg @ 5 : 0.294440, 0.203669
INFO:root:purchase hr and ndcg @5 : 0.451119, 0.323209
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 10: 10757.800000
INFO:root:clicks hr ndcg @ 10 : 0.385589, 0.233248
INFO:root:purchase hr and ndcg @10 : 0.564664, 0.360180
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 15: 12020.000000
INFO:root:clicks hr ndcg @ 15 : 0.433608, 0.245977
INFO:root:purchase hr and ndcg @15 : 0.616726, 0.373986
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 20: 12837.400000
INFO:root:clicks hr ndcg @ 20 : 0.464572, 0.253294
INFO:root:purchase hr and ndcg @20 : 0.651119, 0.382133
INFO:root:#############################################################
INFO:root:the loss in 20200th batch is: 1.103106
INFO:root:the loss in 20400th batch is: 1.112040
INFO:root:the loss in 20600th batch is: 1.140438
INFO:root:the loss in 20800th batch is: 1.186341
INFO:root:the loss in 21000th batch is: 1.172614
INFO:root:the loss in 21200th batch is: 1.135563
INFO:root:the loss in 21400th batch is: 1.144892
INFO:root:the loss in 21600th batch is: 1.073390
INFO:root:the loss in 21800th batch is: 1.173899
INFO:root:the loss in 22000th batch is: 1.030554
