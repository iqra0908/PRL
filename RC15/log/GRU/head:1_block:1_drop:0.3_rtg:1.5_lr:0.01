WARNING:tensorflow:From /Users/xin/Documents/RL4REC/RC15/GRU_PRL.py:116: The name tf.random_normal is deprecated. Please use tf.random.normal instead.

WARNING:tensorflow:From /Users/xin/Documents/RL4REC/RC15/GRU_PRL.py:53: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /Users/xin/Documents/RL4REC/RC15/GRU_PRL.py:64: GRUCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.GRUCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /Users/xin/Documents/RL4REC/RC15/GRU_PRL.py:67: dynamic_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell)`, which is equivalent to this API
WARNING:tensorflow:From /Users/xin/miniconda3/envs/tf-1.15/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:559: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /Users/xin/miniconda3/envs/tf-1.15/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:565: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /Users/xin/miniconda3/envs/tf-1.15/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:575: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /Users/xin/miniconda3/envs/tf-1.15/lib/python3.7/site-packages/tensorflow_core/python/ops/rnn.py:244: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /Users/xin/Documents/RL4REC/RC15/GRU_PRL.py:80: dropout (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.dropout instead.
WARNING:tensorflow:From /Users/xin/miniconda3/envs/tf-1.15/lib/python3.7/site-packages/tensorflow_core/python/layers/core.py:271: Layer.apply (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.__call__` method instead.
WARNING:tensorflow:From /Users/xin/Documents/RL4REC/RC15/GRU_PRL.py:85: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /Users/xin/Documents/RL4REC/RC15/SASRecModules.py:142: dense (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.Dense instead.
WARNING:tensorflow:From /Users/xin/Documents/RL4REC/RC15/SASRecModules.py:223: conv1d (from tensorflow.python.layers.convolutional) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.keras.layers.Conv1D` instead.
WARNING:tensorflow:From /Users/xin/Documents/RL4REC/RC15/GRU_PRL.py:112: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /Users/xin/Documents/RL4REC/RC15/GRU_PRL.py:235: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /Users/xin/Documents/RL4REC/RC15/GRU_PRL.py:238: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

WARNING:tensorflow:From /Users/xin/Documents/RL4REC/RC15/GRU_PRL.py:240: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

INFO:root:the loss in 200th batch is: 8.340604
INFO:root:the loss in 400th batch is: 7.709915
INFO:root:the loss in 600th batch is: 7.406129
INFO:root:the loss in 800th batch is: 7.079046
INFO:root:the loss in 1000th batch is: 6.784698
INFO:root:the loss in 1200th batch is: 6.414803
INFO:root:the loss in 1400th batch is: 6.387653
INFO:root:the loss in 1600th batch is: 6.519024
INFO:root:the loss in 1800th batch is: 6.173333
INFO:root:the loss in 2000th batch is: 6.071011
INFO:root:#############################################################
INFO:root:total clicks: 108416, total purchase:4245
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 5: 7175.200000
INFO:root:clicks hr ndcg @ 5 : 0.257766, 0.176699
INFO:root:purchase hr and ndcg @5 : 0.373616, 0.259613
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 10: 9547.600000
INFO:root:clicks hr ndcg @ 10 : 0.344442, 0.204847
INFO:root:purchase hr and ndcg @10 : 0.489753, 0.297459
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 15: 10735.000000
INFO:root:clicks hr ndcg @ 15 : 0.388826, 0.216609
INFO:root:purchase hr and ndcg @15 : 0.542756, 0.311497
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 20: 11488.800000
INFO:root:clicks hr ndcg @ 20 : 0.417549, 0.223398
INFO:root:purchase hr and ndcg @20 : 0.573616, 0.318778
INFO:root:#############################################################
INFO:root:the loss in 2200th batch is: 6.094338
INFO:root:the loss in 2400th batch is: 6.226489
INFO:root:the loss in 2600th batch is: 5.808698
INFO:root:the loss in 2800th batch is: 6.019494
INFO:root:the loss in 3000th batch is: 5.953286
INFO:root:the loss in 3200th batch is: 6.316002
INFO:root:the loss in 3400th batch is: 5.602398
INFO:root:the loss in 3600th batch is: 5.727565
INFO:root:the loss in 3800th batch is: 5.973716
INFO:root:the loss in 4000th batch is: 6.189070
INFO:root:#############################################################
INFO:root:total clicks: 108416, total purchase:4245
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 5: 7967.400000
INFO:root:clicks hr ndcg @ 5 : 0.288214, 0.198523
INFO:root:purchase hr and ndcg @5 : 0.404711, 0.286345
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 10: 10455.000000
INFO:root:clicks hr ndcg @ 10 : 0.380894, 0.228593
INFO:root:purchase hr and ndcg @10 : 0.517314, 0.322750
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 15: 11688.000000
INFO:root:clicks hr ndcg @ 15 : 0.427105, 0.240853
INFO:root:purchase hr and ndcg @15 : 0.571731, 0.337193
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 20: 12495.600000
INFO:root:clicks hr ndcg @ 20 : 0.457432, 0.248025
INFO:root:purchase hr and ndcg @20 : 0.607067, 0.345559
INFO:root:#############################################################
INFO:root:the loss in 4200th batch is: 5.989284
INFO:root:the loss in 4400th batch is: 5.446181
INFO:root:the loss in 4600th batch is: 5.836525
INFO:root:the loss in 4800th batch is: 5.560363
INFO:root:the loss in 5000th batch is: 5.473636
INFO:root:the loss in 5200th batch is: 5.663540
INFO:root:the loss in 5400th batch is: 6.144607
INFO:root:the loss in 5600th batch is: 5.871192
INFO:root:the loss in 5800th batch is: 5.865226
INFO:root:the loss in 6000th batch is: 5.876420
INFO:root:#############################################################
INFO:root:total clicks: 108416, total purchase:4245
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 5: 8232.600000
INFO:root:clicks hr ndcg @ 5 : 0.299799, 0.205666
INFO:root:purchase hr and ndcg @5 : 0.408009, 0.285983
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 10: 10730.000000
INFO:root:clicks hr ndcg @ 10 : 0.393115, 0.235963
INFO:root:purchase hr and ndcg @10 : 0.519670, 0.322432
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 15: 11993.800000
INFO:root:clicks hr ndcg @ 15 : 0.440424, 0.248512
INFO:root:purchase hr and ndcg @15 : 0.575736, 0.337328
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 20: 12783.600000
INFO:root:clicks hr ndcg @ 20 : 0.470669, 0.255667
INFO:root:purchase hr and ndcg @20 : 0.607303, 0.344788
INFO:root:#############################################################
INFO:root:the loss in 6200th batch is: 5.671919
INFO:root:the loss in 6400th batch is: 5.682848
INFO:root:the loss in 6600th batch is: 5.763625
INFO:root:the loss in 6800th batch is: 5.546554
INFO:root:the loss in 7000th batch is: 5.724172
INFO:root:the loss in 7200th batch is: 5.474851
INFO:root:the loss in 7400th batch is: 5.341485
INFO:root:the loss in 7600th batch is: 5.576097
INFO:root:the loss in 7800th batch is: 5.512603
INFO:root:the loss in 8000th batch is: 5.800201
INFO:root:#############################################################
INFO:root:total clicks: 108416, total purchase:4245
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 5: 8338.600000
INFO:root:clicks hr ndcg @ 5 : 0.304595, 0.209562
INFO:root:purchase hr and ndcg @5 : 0.408481, 0.285145
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 10: 10880.800000
INFO:root:clicks hr ndcg @ 10 : 0.398594, 0.240041
INFO:root:purchase hr and ndcg @10 : 0.527208, 0.323862
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 15: 12171.400000
INFO:root:clicks hr ndcg @ 15 : 0.447000, 0.252870
INFO:root:purchase hr and ndcg @15 : 0.583981, 0.338952
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 20: 13018.400000
INFO:root:clicks hr ndcg @ 20 : 0.478776, 0.260384
INFO:root:purchase hr and ndcg @20 : 0.621201, 0.347746
INFO:root:#############################################################
INFO:root:the loss in 8200th batch is: 5.363730
INFO:root:the loss in 8400th batch is: 5.695051
INFO:root:the loss in 8600th batch is: 5.403747
INFO:root:the loss in 8800th batch is: 5.828575
INFO:root:the loss in 9000th batch is: 5.820624
INFO:root:the loss in 9200th batch is: 5.507300
INFO:root:the loss in 9400th batch is: 5.606127
INFO:root:the loss in 9600th batch is: 5.565239
INFO:root:the loss in 9800th batch is: 5.680888
INFO:root:the loss in 10000th batch is: 5.404467
INFO:root:#############################################################
INFO:root:total clicks: 108416, total purchase:4245
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 5: 8404.600000
INFO:root:clicks hr ndcg @ 5 : 0.307178, 0.211328
INFO:root:purchase hr and ndcg @5 : 0.410836, 0.288239
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 10: 10938.000000
INFO:root:clicks hr ndcg @ 10 : 0.401002, 0.241752
INFO:root:purchase hr and ndcg @10 : 0.528386, 0.326416
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 15: 12199.200000
INFO:root:clicks hr ndcg @ 15 : 0.448651, 0.254384
INFO:root:purchase hr and ndcg @15 : 0.582097, 0.340666
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 20: 13046.600000
INFO:root:clicks hr ndcg @ 20 : 0.480676, 0.261952
INFO:root:purchase hr and ndcg @20 : 0.618139, 0.349176
INFO:root:#############################################################
INFO:root:the loss in 10200th batch is: 5.434085
INFO:root:the loss in 10400th batch is: 5.403078
INFO:root:the loss in 10600th batch is: 5.245955
INFO:root:the loss in 10800th batch is: 5.604156
INFO:root:the loss in 11000th batch is: 5.397206
INFO:root:the loss in 11200th batch is: 5.650910
INFO:root:the loss in 11400th batch is: 5.346441
INFO:root:the loss in 11600th batch is: 5.539059
INFO:root:the loss in 11800th batch is: 5.538288
INFO:root:the loss in 12000th batch is: 5.359198
INFO:root:#############################################################
INFO:root:total clicks: 108416, total purchase:4245
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 5: 8493.400000
INFO:root:clicks hr ndcg @ 5 : 0.310213, 0.212831
INFO:root:purchase hr and ndcg @5 : 0.416254, 0.292434
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 10: 10995.000000
INFO:root:clicks hr ndcg @ 10 : 0.403907, 0.243231
INFO:root:purchase hr and ndcg @10 : 0.526973, 0.328287
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 15: 12293.400000
INFO:root:clicks hr ndcg @ 15 : 0.452489, 0.256112
INFO:root:purchase hr and ndcg @15 : 0.584688, 0.343607
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 20: 13110.200000
INFO:root:clicks hr ndcg @ 20 : 0.483471, 0.263432
INFO:root:purchase hr and ndcg @20 : 0.618846, 0.351708
INFO:root:#############################################################
INFO:root:the loss in 12200th batch is: 5.505530
INFO:root:the loss in 12400th batch is: 5.085458
INFO:root:the loss in 12600th batch is: 5.336326
INFO:root:the loss in 12800th batch is: 5.446529
INFO:root:the loss in 13000th batch is: 5.288722
INFO:root:the loss in 13200th batch is: 5.484444
INFO:root:the loss in 13400th batch is: 5.679371
INFO:root:the loss in 13600th batch is: 5.595144
INFO:root:the loss in 13800th batch is: 5.385426
INFO:root:the loss in 14000th batch is: 5.589748
INFO:root:#############################################################
INFO:root:total clicks: 108416, total purchase:4245
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 5: 8476.600000
INFO:root:clicks hr ndcg @ 5 : 0.309023, 0.213183
INFO:root:purchase hr and ndcg @5 : 0.418375, 0.296149
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 10: 11064.400000
INFO:root:clicks hr ndcg @ 10 : 0.405586, 0.244568
INFO:root:purchase hr and ndcg @10 : 0.534747, 0.333969
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 15: 12311.000000
INFO:root:clicks hr ndcg @ 15 : 0.453531, 0.257286
INFO:root:purchase hr and ndcg @15 : 0.583510, 0.346881
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 20: 13151.000000
INFO:root:clicks hr ndcg @ 20 : 0.485307, 0.264797
INFO:root:purchase hr and ndcg @20 : 0.619081, 0.355300
INFO:root:#############################################################
INFO:root:the loss in 14200th batch is: 5.370248
INFO:root:the loss in 14400th batch is: 5.439708
INFO:root:the loss in 14600th batch is: 5.047592
INFO:root:the loss in 14800th batch is: 5.375280
INFO:root:the loss in 15000th batch is: 5.510416
INFO:root:the loss in 15200th batch is: 5.219913
INFO:root:the loss in 15400th batch is: 5.262892
INFO:root:the loss in 15600th batch is: 5.454713
INFO:root:the loss in 15800th batch is: 5.028589
INFO:root:the loss in 16000th batch is: 5.482677
