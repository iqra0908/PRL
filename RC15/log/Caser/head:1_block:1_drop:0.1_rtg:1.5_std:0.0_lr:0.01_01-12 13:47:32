WARNING:tensorflow:From /Users/xin/Documents/RL4REC/RC15/Caser_PRL.py:179: The name tf.random_normal is deprecated. Please use tf.random.normal instead.

WARNING:tensorflow:From /Users/xin/Documents/RL4REC/RC15/Caser_PRL.py:60: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /Users/xin/Documents/RL4REC/RC15/Caser_PRL.py:70: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
WARNING:tensorflow:From /Users/xin/Documents/RL4REC/RC15/Caser_PRL.py:84: The name tf.truncated_normal is deprecated. Please use tf.random.truncated_normal instead.

WARNING:tensorflow:From /Users/xin/Documents/RL4REC/RC15/Caser_PRL.py:98: The name tf.nn.max_pool is deprecated. Please use tf.nn.max_pool2d instead.

WARNING:tensorflow:From /Users/xin/Documents/RL4REC/RC15/Caser_PRL.py:129: dropout (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.dropout instead.
WARNING:tensorflow:From /Users/xin/miniconda3/envs/tf-1.15/lib/python3.7/site-packages/tensorflow_core/python/layers/core.py:271: Layer.apply (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.__call__` method instead.
WARNING:tensorflow:From /Users/xin/Documents/RL4REC/RC15/Caser_PRL.py:146: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /Users/xin/Documents/RL4REC/RC15/SASRecModules.py:142: dense (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.Dense instead.
WARNING:tensorflow:From /Users/xin/Documents/RL4REC/RC15/SASRecModules.py:163: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /Users/xin/Documents/RL4REC/RC15/Caser_PRL.py:175: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /Users/xin/Documents/RL4REC/RC15/Caser_PRL.py:298: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

WARNING:tensorflow:From /Users/xin/Documents/RL4REC/RC15/Caser_PRL.py:301: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

WARNING:tensorflow:From /Users/xin/Documents/RL4REC/RC15/Caser_PRL.py:303: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

INFO:root:the loss in 200th batch is: 1.899742
INFO:root:the loss in 400th batch is: 1.616099
INFO:root:the loss in 600th batch is: 1.468311
INFO:root:the loss in 800th batch is: 1.460177
INFO:root:the loss in 1000th batch is: 1.402335
INFO:root:the loss in 1200th batch is: 1.323387
INFO:root:the loss in 1400th batch is: 1.263233
INFO:root:the loss in 1600th batch is: 1.207791
INFO:root:the loss in 1800th batch is: 1.307794
INFO:root:the loss in 2000th batch is: 1.327278
INFO:root:#############################################################
INFO:root:total clicks: 108416, total purchase:4245
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 5: 7689.200000
INFO:root:clicks hr ndcg @ 5 : 0.267313, 0.182850
INFO:root:purchase hr and ndcg @5 : 0.445936, 0.314967
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 10: 10088.400000
INFO:root:clicks hr ndcg @ 10 : 0.355547, 0.211480
INFO:root:purchase hr and ndcg @10 : 0.560424, 0.352389
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 15: 11284.000000
INFO:root:clicks hr ndcg @ 15 : 0.400679, 0.223436
INFO:root:purchase hr and ndcg @15 : 0.611543, 0.365986
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 20: 12092.400000
INFO:root:clicks hr ndcg @ 20 : 0.431874, 0.230806
INFO:root:purchase hr and ndcg @20 : 0.642638, 0.373343
INFO:root:#############################################################
INFO:root:the loss in 2200th batch is: 1.278972
INFO:root:the loss in 2400th batch is: 1.382451
INFO:root:the loss in 2600th batch is: 1.185435
INFO:root:the loss in 2800th batch is: 1.183582
INFO:root:the loss in 3000th batch is: 1.239179
INFO:root:the loss in 3200th batch is: 1.126358
INFO:root:the loss in 3400th batch is: 1.160742
INFO:root:the loss in 3600th batch is: 1.191369
INFO:root:the loss in 3800th batch is: 1.214332
INFO:root:the loss in 4000th batch is: 1.247515
INFO:root:#############################################################
INFO:root:total clicks: 108416, total purchase:4245
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 5: 8069.000000
INFO:root:clicks hr ndcg @ 5 : 0.282569, 0.195141
INFO:root:purchase hr and ndcg @5 : 0.457479, 0.324324
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 10: 10555.200000
INFO:root:clicks hr ndcg @ 10 : 0.374862, 0.225097
INFO:root:purchase hr and ndcg @10 : 0.571731, 0.361306
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 15: 11836.600000
INFO:root:clicks hr ndcg @ 15 : 0.422659, 0.237764
INFO:root:purchase hr and ndcg @15 : 0.629446, 0.376602
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 20: 12658.000000
INFO:root:clicks hr ndcg @ 20 : 0.454177, 0.245212
INFO:root:purchase hr and ndcg @20 : 0.661955, 0.384285
INFO:root:#############################################################
INFO:root:the loss in 4200th batch is: 1.074152
INFO:root:the loss in 4400th batch is: 1.176417
INFO:root:the loss in 4600th batch is: 1.045211
INFO:root:the loss in 4800th batch is: 1.059682
INFO:root:the loss in 5000th batch is: 1.184461
INFO:root:the loss in 5200th batch is: 1.075769
INFO:root:the loss in 5400th batch is: 1.121938
INFO:root:the loss in 5600th batch is: 1.111710
INFO:root:the loss in 5800th batch is: 1.161386
INFO:root:the loss in 6000th batch is: 1.089724
INFO:root:#############################################################
INFO:root:total clicks: 108416, total purchase:4245
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 5: 8267.200000
INFO:root:clicks hr ndcg @ 5 : 0.289496, 0.198926
INFO:root:purchase hr and ndcg @5 : 0.468787, 0.334121
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 10: 10724.000000
INFO:root:clicks hr ndcg @ 10 : 0.381540, 0.228759
INFO:root:purchase hr and ndcg @10 : 0.577385, 0.369433
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 15: 11999.800000
INFO:root:clicks hr ndcg @ 15 : 0.429863, 0.241558
INFO:root:purchase hr and ndcg @15 : 0.631095, 0.383714
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 20: 12853.000000
INFO:root:clicks hr ndcg @ 20 : 0.461786, 0.249109
INFO:root:purchase hr and ndcg @20 : 0.669022, 0.392686
INFO:root:#############################################################
INFO:root:the loss in 6200th batch is: 1.095946
INFO:root:the loss in 6400th batch is: 1.124636
INFO:root:the loss in 6600th batch is: 1.064074
INFO:root:the loss in 6800th batch is: 1.105814
INFO:root:the loss in 7000th batch is: 1.115701
INFO:root:the loss in 7200th batch is: 1.089823
INFO:root:the loss in 7400th batch is: 1.017616
INFO:root:the loss in 7600th batch is: 1.054156
INFO:root:the loss in 7800th batch is: 1.120887
INFO:root:the loss in 8000th batch is: 1.115740
INFO:root:#############################################################
INFO:root:total clicks: 108416, total purchase:4245
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 5: 8272.800000
INFO:root:clicks hr ndcg @ 5 : 0.291138, 0.201124
INFO:root:purchase hr and ndcg @5 : 0.461720, 0.331658
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 10: 10774.200000
INFO:root:clicks hr ndcg @ 10 : 0.384731, 0.231422
INFO:root:purchase hr and ndcg @10 : 0.572909, 0.367674
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 15: 12052.400000
INFO:root:clicks hr ndcg @ 15 : 0.432335, 0.244037
INFO:root:purchase hr and ndcg @15 : 0.630860, 0.383072
INFO:root:~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
INFO:root:cumulative reward @ 20: 12885.200000
INFO:root:clicks hr ndcg @ 20 : 0.463778, 0.251463
INFO:root:purchase hr and ndcg @20 : 0.666431, 0.391494
INFO:root:#############################################################
INFO:root:the loss in 8200th batch is: 1.122882
INFO:root:the loss in 8400th batch is: 1.095708
INFO:root:the loss in 8600th batch is: 1.137888
INFO:root:the loss in 8800th batch is: 1.081852
INFO:root:the loss in 9000th batch is: 1.152848
INFO:root:the loss in 9200th batch is: 1.147959
INFO:root:the loss in 9400th batch is: 1.029483
INFO:root:the loss in 9600th batch is: 0.986215
INFO:root:the loss in 9800th batch is: 1.099226
